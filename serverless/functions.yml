functions:
  authorizerFunc:
    handler: src/infra/http/handlers/authorizer.handler

  generateUploadUrl:
    handler: src/infra/http/handlers/generate-upload-url.handler
    timeout: 15
    events:
      - httpApi:
          path: /uploads/presign
          method: post
          authorizer:
            name: tokenAuthorizer

  generateJWT:
    handler: src/infra/http/handlers/generate-jwt.handler
    timeout: 15
    events:
      - httpApi:
          path: /auth
          method: post

  processUploadFile:
    handler: src/infra/http/handlers/process-upload.handler
    timeout: 15
    events:
      - s3:
          bucket: ${self:provider.environment.MEDIA_BUCKET_NAME}
          event: s3:ObjectCreated:*
          existing: true
